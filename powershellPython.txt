// $frequency = (-Once, -Daily, -Weekly, -Monthly)
// $time = 11am (etc.)
// $exe_path = "C:\Users\<--->\PycharmProjects\pharma_app\main.py"
$action = New-ScheduledTaskAction -Execute $exe_path -Argument "<arg>"
$trigger = New-ScheduledTaskTrigger $frequency -At $time


//$trigger.StartBoundary = [DateTime]::Parse($trigger.StartBoundary).ToLocalTime().ToString("s")
//$settings = New-ScheduledTaskSettingsSet -ExecutionTimeLimit 0
// -Settings $settings
Register-ScheduledTask -Action $action -Trigger $trigger -TaskPath "medCSV" -TaskName "medical csv download" -Description "download csv"






def run(cmd):
    completed = subprocess.run(["powershell", "-Command", cmd], capture_output=True)
    return completed


hello_command = "Write-Host 'Hello Wolrd!'"

hello_info = run(hello_command)

if hello_info.returncode != 0:
    print("An error occured: %s", hello_info.stderr)
else:
    print("Hello command executed successfully!")

print("-------------------------")

bad_syntax_command = "Write-Hst 'Incorrect syntax command!'"
bad_syntax_info = run(bad_syntax_command)
if bad_syntax_info.returncode != 0:
    print("An error occured: %s", bad_syntax_info.stderr)
else:
    print("Bad syntax command executed successfully!")


